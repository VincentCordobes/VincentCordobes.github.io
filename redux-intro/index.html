<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/app.09ca7e2f2c722cbd6750.css">*,:after,:before{box-sizing:border-box}body{color:#3d3d3d;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Helvetica Neue,Arial,sans-serif;font-size:16px;margin:0 auto;padding:15px;line-height:1.5;-webkit-text-size-adjust:100%}a{color:#0366d6;text-decoration:none}a:hover{text-decoration:underline}p{margin:0 0 1em}#layout{max-width:42rem;margin-left:auto;margin-right:auto}h1,h2,h3,h4{line-height:normal;margin:0;font-weight:500}h1{font-size:2em}h2,h3,h4{margin-top:1.5em;margin-bottom:.5em}h2{font-size:1.5em}h3{font-size:1.25em}h4{font-size:1em}ol,ul{padding-left:0;margin:5px 0 1em;list-style-type:none}ol>li,ul>li{text-indent:0;margin:.3em 0}p+ol,p+ul{margin-top:-.7em}ol{list-style-type:decimal}hr{background-color:#e1e4e8;border:0;height:1px;margin:24px 0;padding:0}.vim-cursor{display:inline-block;background-color:#5f5f5e;color:#fff;margin-bottom:-5px;margin-left:3px;width:10px;height:18px}blockquote{margin:1.5em 0 1.5em 1.8em;color:#5a5a5a;position:relative;font-style:italic}blockquote:before{font-family:georgia,serif;font-size:3.6em;position:absolute;content:"\201C";line-height:1em;font-style:normal;left:-.5em;top:0}cite{display:block;text-align:right;color:#3d3d3d}cite:before{content:"\2014   "}table{border:2px solid #000;border-right:none;border-left:none;border-collapse:collapse;min-width:100%;margin:2em auto}@media (min-width:576px){table{min-width:20rem}}td,th{padding:5px 10px;text-align:left}th{border-bottom:1px solid #000}.mono{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace}#post-list .date{color:#aaa}figure{margin:0 0 1.4em}figcaption:before{font-variant:small-caps}figcaption{text-align:center;margin-top:1em;margin-bottom:1.4em}iframe{border:none;width:1px;min-width:100%;margin:0 auto 1em}img{max-width:100%;display:block;margin:0 auto}</style><style data-href="/component---src-templates-blog-post-js.0273d00f9c3a2ee6a32a.css">code[class*=language-],pre[class*=language-]{color:#393a34;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#c1def1}pre[class*=language-]{padding:1em;margin:1em 0;overflow:auto;border-radius:4px;background-color:#f6f8fa}:not(pre)>code[class*=language-]{padding:1px .2em;background:#f8f8f8;background-color:rgba(27,31,35,.05);border-radius:4px}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:green;font-style:italic}.token.namespace{opacity:.7}.token.string{color:#a31515}.token.operator,.token.punctuation{color:#393a34}.token.boolean,.token.constant,.token.inserted,.token.number,.token.symbol,.token.url,.token.variable{color:#36acaa}.language-autohotkey .token.selector,.language-json .token.boolean,.language-json .token.number,.token.atrule,.token.attr-value,.token.keyword,code[class*=language-css]{color:#00f}.token.function{color:#393a34}.language-autohotkey .token.tag,.token.deleted{color:#9a050f}.language-autohotkey .token.keyword,.token.selector{color:#00009f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.language-json .token.property,.token.class-name{color:#2b91af}.token.selector,.token.tag{color:maroon}.token.attr-name,.token.entity,.token.property,.token.regex{color:red}.token.directive.tag .tag{background:#ff0;color:#393a34}.line-numbers .line-numbers-rows{border-right-color:#a5a5a5}.line-numbers-rows>span:before{color:#2b91af}.line-highlight{background:rgba(193,222,241,.2);background:linear-gradient(90deg,rgba(193,222,241,.2) 70%,rgba(221,222,241,0))}code{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace}pre{font-size:.9em}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}#blog-post nav>ul{padding:0}#blog-post-content{overflow:hidden}#blog-post-content ol,#blog-post-content ul{padding-left:1.5em}#blog-post-content ul>li{list-style-type:disc}#blog-post-footer{display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0}</style><meta name="generator" content="Gatsby 2.0.73"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><title data-react-helmet="true">Architecture Redux - Vincent&#x27;s page</title><link data-react-helmet="true" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous"/><meta data-react-helmet="true" name="google-site-verification" content="kjM2mfXvQ9XJ7BqEPTHNHWZ62wJsC5G_GtuPX1oy0EY"/><meta data-react-helmet="true" name="description" content="Des bons concepts"/><meta data-react-helmet="true" property="og:url" content="https://vincentcordobes.github.io/redux-intro/"/><meta data-react-helmet="true" property="og:title" content="Architecture Redux"/><meta data-react-helmet="true" name="og:description" content="Des bons concepts"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@VincentCordobes"/><meta data-react-helmet="true" name="twitter:title" content="Architecture Redux"/><meta data-react-helmet="true" name="twitter:description" content="Des bons concepts"/><link as="script" rel="preload" href="/2-fa6b8c6d780855218470.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-31837fd94e4e7ce3bd89.js"/><link as="script" rel="preload" href="/1-3ef15578a534496303af.js"/><link as="script" rel="preload" href="/app-7b9fefaca9b521afc2fb.js"/><link as="script" rel="preload" href="/webpack-runtime-461aa482148314fb252b.js"/><link as="fetch" rel="preload" href="/static/d/138/path---redux-intro-721-c9a-JHoP7t3bMq0UXtEacA17tEbdGo.json" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div id="layout"><div id="blog-post"><header><nav><ul><li><a rel="home" href="/">Home</a></li></ul></nav></header><h1>Architecture Redux</h1><p><small class="mono">December 17, 2016</small></p><div id="blog-post-content"><p><em>React</em> fournit seulement un moyen de dessiner de manière efficace des
composants en fonction de données d’entrées.</p>
<p>Flux est un <em>pattern</em> permettant de gérer <strong>l’état d’une application</strong> qui garanti un flux de données
unidirectionnel (<em>one way databinding</em>) Redux est l’implémentation
la plus populaire.</p>
<p>Redux, met en scène 3 principes :</p>
<ul>
<li><strong>une seule source de vérité</strong> : le <em>state</em> de l’application est maintenu dans une structure de données à l’intérieur d’un seul store</li>
<li>le state est <strong>immutable</strong> : La seule manière de modifier le <em>state</em> est via l’émission d’une <strong>action</strong>, un objet décrivant la modification à apporter. Toutes les modifications sont centralisées et se produisent une à une, évitant ainsi les problèmes de concurrence</li>
<li>les modifications sont effectuées à l’aide de <strong>fonction pures</strong> appelées <strong>reducers</strong></li>
</ul>
<figure><img style="width:max-content" src="/flux-eec49feb72d494c46fe2f4afae80bd77.svg"><figcaption>Architecture Redux</figcaption></figure>
<p>Le schéma illustre le flux unidirectionnel des données dans cette architecture : des <strong>actions</strong> sont <em>dispatchées</em> et traitées par le <strong>reducer</strong>, qui se charge de mettre à jour le store. Toutes les vues (ici les composants react) abonnées au store se mettent à jour en conséquence. Ces vues peuvent également <em>dispatcher</em> des actions et ainsi de suite.</p>
<h3>Actions et Actions creators</h3>
<p>Les actions sont des paquets de données envoyés au <em>store</em>. Elles
sont la seule source d’information du store. Une action est envoyée au
store grâce à la fonction <code class="language-text">store.dispatch</code>.</p>
<p>Voici un exemple d’action qui représente le
changement de nom d’une personne :</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">'CHANGE_NAME'</span><span class="token punctuation">,</span>
  payload<span class="token punctuation">:</span> <span class="token string">'Vince'</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Si cette action se révèle être utilisée souvent, nous pouvons écrire une fonction qui se chargera de la créer.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">changeName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">'CHANGE_NAME'</span><span class="token punctuation">,</span>
    payload<span class="token punctuation">:</span> name<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>On appelle ces fonctions des <strong>action creator</strong>. Elles rendent les actions réutilisables et facilement testables.
Les actions peuvent être “dispatchées” avec : <code class="language-text">dispatch(changeName(&#39;Vincent&#39;))</code></p>
<h3>Reducer</h3>
<p>Les actions décrivent le fait que quelque chose s’est passé mais ne
spécifient pas la manière dont le store doit être modifié. C’est le rôle
du reducer, une <strong>fonction pure</strong> qui prend en
paramètre le <em>state</em>, une action, et retourne le nouveau <em>state</em>.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(previousState, action) =&gt; nextState</code></pre></div>
<p>Le <em>reducer</em> est une fonction pure, par conséquent il ne doit <strong>jamais</strong>:</p>
<ul>
<li>modifier directement ses arguments</li>
<li>effectuer des opérations ayant des effets de bord tel que des appels à une api</li>
<li>appeler des fonctions impures telles que <code class="language-text">Date.now()</code> etc…</li>
</ul>
<p>Il est uniquement chargé de calculer le <em>nextState</em>.</p>
<h4>✘ Exemple: un reducer incorrect, mutation du state INTERDITE!</h4>
<p>Le <em>state</em> est muté.
La propriété du <em>state</em> étant modifiée directement (l.4),
les composants abonnés à cette partie du <em>state</em> ne se mettrons pas à jour et ignorerons cette modification.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">user</span><span class="token punctuation">(</span>state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'CHANGE_NAME'</span><span class="token punctuation">:</span>
      state<span class="token punctuation">.</span>name <span class="token operator">=</span> action<span class="token punctuation">.</span>name <span class="token comment">// INTERDIT !!</span>
      <span class="token keyword">return</span> state 
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h4>✔ Exemple Un reducer correct</h4>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">user</span><span class="token punctuation">(</span>state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'CHANGE_NAME'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> action<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><em><strong>Note</strong> : On utilise ici l’opérateur object spread <code class="language-text">...</code>, une syntaxe d’ECMAScript 2016, qui permet de copier les propriétés d’un
objet dans un nouvel objet d’une manière plus succincte. Nous pouvons également utiliser des bibliothèques qui garantissent l’immutabilité telles que <a href="https://github.com/facebook/immutable-js/">immutable.js</a> développée par Facebook</em></p>
<!-- <h6>TODO: combineReducer pour réduire le boilerplate</h6> -->
<h3>Store</h3>
<p>Le <em>store</em> est un objet qui :</p>
<ul>
<li>maintient le <em>state</em> de l’application</li>
<li>permet l’accès à ce <em>state</em> via <code class="language-text">getState()</code></li>
<li>permet de mettre à jour le <em>state</em> via <code class="language-text">dispatch(action)</code></li>
<li>permet d’abonner des composants via <code class="language-text">subscribe(listener)</code> (composants notifiés lorsque le <em>state</em> subit une modification)</li>
</ul>
<h3>Async Actions</h3>
<p>Afin d’orchestrer des flux asynchrones (par exemple, les appels réseaux) nous pouvons utiliser le <em>middleware</em> <em>Redux-thunk</em>.
<em>Ce _middleware</em> permet de traiter les actions étant des fonctions (appelées <em>thunk action</em>).
Une action <em>thunk</em> ne doit pas forcément être pure et peut avoir des effets de bords. Les fonctions <em>dispatch</em> et <em>getState</em> du store lui sont passées en argument, ce qui lui donne la possibilité de <em>dispatcher</em> d’autres <em>actions</em> et d’accéder au <em>state</em>.</p>
<h4>Exemple d’un thunk action creator qui renvoie une fonction :</h4>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">whatIsMyName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">fetchNameRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://vincent.cordobes/name'</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">fetchNameSuccess</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">fetchNameError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>L’exemple ci-dessus met en évidence une <em>action creator</em> qui retourne une fonction. Des actions marquant le début, le succès ou une erreur de l’appel (l.5) à l’API sont “dispatchées” (l.3, l.7, l.9) permettant de mettre à jour le <em>store</em> en fonction de l’avancement de la requête.</p>
<p><em>Remarques relativement au code ci-dessus : syntaxe avec les mots clés async/await. Cette syntaxe fait son apparition dans ECMAScript 2017. En résumé, <code class="language-text">await</code> permet d’attendre la résolution d’une promesse et ne peux être utilisé que dans une fonction préfixée par <code class="language-text">async</code> (elle-même renverra à son tour une promesse) Il permet d’écrire le code asynchrone de javascript à la manière d’un code synchrone.</em></p>
<h3>Composants containers et composants visuels</h3>
<p>La séparation <em>container</em>/<em>presentational</em> est d’autant plus vrai dans redux.
Ces deux termes proviennent, en l’occurrence, du créateur de redux <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.xbauu6f3x">smart and dumb components</a></p>
<h4>Container</h4>
<ul>
<li>Responsables de la manière dont <em>les choses</em> fonctionnent</li>
<li>Dispatchent les actions flux</li>
<li>Transmettent des données et comportements aux composants <em>presentational</em> via leur <em>props</em></li>
<li>Peuvent contenir des composants <em>présentation</em> et <em>container</em></li>
<li>Ne contiennent pas d’éléments du DOM ni de styles</li>
<li>Peuvent être générés par connect()</li>
</ul>
<h4>Visuels</h4>
<ul>
<li>Responsables de la manière dont <em>les choses</em> apparaissent sur l’interface</li>
<li>Peuvent contenir des composants <em>présentation</em> et <em>container</em></li>
<li>possèdent souvent des éléments DOM et du style</li>
<li>Indépendants du reste de l’application</li>
<li>Ne spécifient pas la manière dont les données sont chargés ou modifiées</li>
<li>Reçoivent les données et les callback exclusivement via leurs props</li>
<li>Possèdent uniquement un <em>state</em> si celui-ci concerne l’UI (et non des data)</li>
<li>Souvent écrits sous forme de fonctions</li>
</ul>
<h3>Utilisation des selecteurs</h3>
<p>Afin de comprendre l’utilité des sélecteurs, prenons un exemple.
Considérons une liste de personnes, une recherche (par nom) et des filtres (sexe, age, etc…) sur ces personnes.</p>
<p>En suivant les principes <em>Redux</em>, le <em>store</em> contient les données et les critères de recherche.
À partir de ces éléments nous pouvons calculer la liste filtrée à afficher. </p>
<p>Une bonne pratique, concernant le <em>state</em>, est de contenir seulement des donnée minimisée,
c’est-à-dire des données ne pouvant pas être obtenues à partir d’autres données.
Les états dérivés (calculés) ne doivent pas être présents dans le <em>state</em>.</p>
<figure>
<img src="/selectors0-bc881c9cf7496038f4f1a3154c288f66.svg" width="300">
<figcaption>React filtre la data au render</figcaption>
</figure>
<p>Le <em>bon</em> endroit pour filtrer et afficher cette liste est donc la méthode <em>render</em>.
Ainsi, si  un critère de recherche ou si les données changent,
le composant exécute la méthode <code class="language-text">render</code>, filtre les données et les affiche.
Il en résulte une <em>UI</em> toujours synchronisée avec le <em>state</em>. </p>
<p>Cette technique présente néanmoins un inconvénient.
Supposons qu’une <em>props</em> autre que les filtres et la liste de personnes, change :
le filtrage de la liste se fera donc, inutilement, à chaque <em>update</em> du composant.</p>
<p>La complexité de ce filtrage étant du <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>, cela n’est pas très gênant si la taille des données à filtre reste modérée. </p>
<p>Cependant, des listes de données potentiellement grandes ou même un calcul plus  complexe dégraderaient fortement les performances de l’application.</p>
<p>C’est ici qu’entrent en jeu les selectors :</p>
<figure>
  <img src="/selectors-1dca7c8fdfec91367a93fb1aa35a8ac4.svg" width="328">
  <figcaption>Un selecteur filtre la data pour la passer au composant</figcaption>
</figure>
<p>Les <strong>selectors calculent des données dérivées</strong>. Ils permettent au state de ne stocker que les données minimisée.
Ils sont efficaces et ne sont pas recalculés si les arguments restent les mêmes → ils sont <strong>mémoisés</strong>.
Enfin ils sont <em>composables</em>, c’est-à-dire qu’ils peuvent être utilisés en
entrées d’autres selectors.
Ainsi toute la complexité est <em>déplacée</em> à l’exterieur et prise en charge par les selectors,</p>
<p>Les <em>selectors</em> jouent le rôle d’<em>api</em>, permettant un accès au <em>state</em>.
Les composants React ne connaisse que cette interface.
Une conséquence directe est le <em>découplage</em> de ces composants vis-à-vis de la <em>forme</em> du <em>state</em>.
Un autre bénéfice est la simplification du code des composants React.</p>
<h4>Exemple avec la bibliothèque <a href="https://github.com/reactjs/reselect">reselect</a></h4>
<h5>Définition des <em>selectors</em></h5>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">getUsers</span> <span class="token operator">=</span> state <span class="token operator">=></span> state<span class="token punctuation">.</span>users
<span class="token keyword">const</span> <span class="token function-variable function">getSearchTerm</span> <span class="token operator">=</span> state <span class="token operator">=></span> state<span class="token punctuation">.</span>searchTerm

<span class="token comment">// Memoized selector</span>
<span class="token keyword">const</span> getFilteredUsers <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>
  getUsers<span class="token punctuation">,</span>
  getSearchTerm<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>users<span class="token punctuation">,</span> searchTerm<span class="token punctuation">)</span> <span class="token operator">=></span> users<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
    user <span class="token operator">=></span> user<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>searchTerm<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h5>Définition du composant React</h5>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">UserList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> filteredUsers <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>ul<span class="token operator">></span>
    <span class="token punctuation">{</span>filteredUsers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>user <span class="token operator">=></span> <span class="token operator">&lt;</span>li<span class="token operator">></span><span class="token punctuation">{</span>user<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h5>Création du container</h5>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>state <span class="token operator">=></span> <span class="token punctuation">(</span>
  filteredUsers<span class="token punctuation">:</span> <span class="token function">getFilteredUsers</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>UserList<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>Note</strong> : Nous avons seulement besoin de transmettre la liste filtrée au composant UserList. <code class="language-text">connect</code> suffit à créer le composant <em>container</em>.</p>
<h3>Synoptique technique</h3>
<p>Voici un schéma illustrant l’architecture d’une application redux.
Les différentes composantes de ce schéma sont expliquées dans la suite de ce document.</p>
<figure>
  <img src="/synoptique-575081e2b59a5c6a78413c57ba9509e3.svg" width="500">
  <figcaption>Synoptique technique React-Redux</figcaption>
</figure>
<p><strong>Note</strong> : Redux est une bibliothèque dogmatique mettant en scène plusieurs concepts et <em>patterns</em> (immutabilités, flux unidirectionnel etc…) et ces principes sous-jacents peuvent parfaitement s’appliquer à d’autres architectures.</p>
<h3>Références</h3>
<ul>
  <li>Redux doc. <em>https://redux.js.org</em></li>
  <li>Smart and dumb component. <em>https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.h6rxn85kl</em></li>
  <li>React and flux in production best practices. <em>https://medium.com/@delveeng/react-and-flux-in-production-best-practices-c87766c57cb6#.elbdrmo4f</em></li>
</ul></div><div><span style="font-size:0"></span><div class="vim-cursor"></div></div><hr/><ul id="blog-post-footer"><li><a rel="prev" href="/react-intro/">← <!-- -->Introduction à React</a></li><li><a rel="next" href="/git-rebase/">Rewrite the past in fewer steps with rebase<!-- --> →</a></li></ul></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-125838540-1', 'auto', {});
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"redux-intro-721","path":"/redux-intro/"};window.dataPath="138/path---redux-intro-721-c9a-JHoP7t3bMq0UXtEacA17tEbdGo";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app.09ca7e2f2c722cbd6750.css","/app-7b9fefaca9b521afc2fb.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js.0273d00f9c3a2ee6a32a.css","/component---src-templates-blog-post-js-31837fd94e4e7ce3bd89.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d19c26d7bcf68cba1e45.js"],"component---src-pages-activities-js":["/component---src-pages-activities-js-68d06a9c3864c41a3c97.js"],"component---src-pages-git-rebase-figure-1-js":["/component---src-pages-git-rebase-figure-1-js-6f13346e6bffe2748e58.js"],"component---src-pages-git-rebase-figure-2-js":["/component---src-pages-git-rebase-figure-2-js-2d3635297e1b9419fbbf.js"],"component---src-pages-git-rebase-figure-3-js":["/component---src-pages-git-rebase-figure-3-js-2b24912e8a2556d24654.js"],"component---src-pages-git-js":["/component---src-pages-git-js-1957a5c24e4807c4d558.js"],"component---src-pages-index-js":["/component---src-pages-index-js.254b32293e50983661dc.css","/component---src-pages-index-js-7a98193d5b5556fdabe3.js"]};/*]]>*/</script><script src="/webpack-runtime-461aa482148314fb252b.js" async=""></script><script src="/app-7b9fefaca9b521afc2fb.js" async=""></script><script src="/1-3ef15578a534496303af.js" async=""></script><script src="/component---src-templates-blog-post-js-31837fd94e4e7ce3bd89.js" async=""></script><script src="/2-fa6b8c6d780855218470.js" async=""></script></body></html>